

CREATE PROCEDURE DIM_LOCATION_INSERT(
    _COUNTRY VARCHAR(100),
    _TIMEZONE INT,
    _ID INT,
    _LOC_NAME VARCHAR(100),
    _LON NUMERIC,
    _LAT NUMERIC,
    _API_ID NUMERIC,
	_SYS_INSERT_DATETIME TIMESTAMP
)
LANGUAGE plpgsql
AS $$
BEGIN
	INSERT INTO LOCATION (
		COUNTRY,
		TIMEZONE,
		ID,
		LOC_NAME,
		LON,
		LAT,
	    API_ID,
		SYS_INSERT_DATETIME
)
VALUES (
	_COUNTRY
	,_TIMEZONE
	,_ID
	,_LOC_NAME
	,_LON
	,_LAT
	,_API_ID
	,_SYS_INSERT_DATETIME
);
END
$$;


CREATE PROCEDURE DIM_WEATHER_INSERT (
		_ID NUMERIC,
		_MAIN VARCHAR(20),
		DESCR VARCHAR(60),
		_ICON VARCHAR(10),
		_API_ID NUMERIC,
		_SYS_INSERT_DATETIME TIMESTAMP

)
LANGUAGE plpgsql
AS $$
BEGIN
	INSERT INTO DIM_WEATHER (
		ID,
		MAIN,
		DESCR,
		ICON,
		API_ID,
		SYS_INSERT_DATETIME
	)
VALUES (
	_ID,
	_MAIN,
	DESCR,
	_ICON,
	_API_ID,
	_SYS_INSERT_DATETIME
);
END
$$;




CREATE PROCEDURE FACT_MAIN_INSERT (
	_LOCATION_ID INT,
	_WEATHER_ID INT,
	_TEMP NUMERIC,
	_FEELS_LIKE NUMERIC,
	_TEMP_MIN NUMERIC,
	_TEMP_MAX NUMERIC,
	_PRESSURE NUMERIC,
	_HUMIDITY NUMERIC,
	_SEA_LEVEL NUMERIC,
	_GRND_LEVEL NUMERIC,
	_WIND_SPEED NUMERIC,
	_WIND_DEG NUMERIC,
	_WIND_GUST NUMERIC,
	_API_ID NUMERIC,
    _SYS_INSERT_DATETIME TIMESTAMP
)
LANGUAGE plpgsql
AS $$
BEGIN
	INSERT INTO FACT_MAIN (
		LOCATION_ID
		,WEATHER_ID
		,TEMP
		,FEELS_LIKE
		,TEMP_MIN
		,TEMP_MAX
		,PRESSURE
		,HUMIDITY
		,SEA_LEVEL
		,GRND_LEVEL
		,WIND_SPEED
		,WIND_DEG
		,WIND_GUST
		,API_ID
		,SYS_INSERT_DATETIME
)
VALUES (
		LOCATION_ID
		,_WEATHER_ID
		,_TEMP
		,_FEELS_LIKE
		,_TEMP_MIN
		,_TEMP_MAX
		,_PRESSURE
		,_HUMIDITY
		,_SEA_LEVEL
		,_GRND_LEVEL
		,_WIND_SPEED
		,_WIND_DEG
		,_WIND_GUST
		,_API_ID
		,_SYS_INSERT_DATETIME
);
END
$$;
